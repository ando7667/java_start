Применил не очень удачное использование интерфейсов. Переделать бы нужно.
